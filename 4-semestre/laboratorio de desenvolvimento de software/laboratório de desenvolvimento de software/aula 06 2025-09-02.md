# Banco de Dados + Java Swing
---
![[Aula 08 - Banco de dados + Java - Consulta, Editar e Deletar.pdf]]

Utilizando o banco de dados e a conexão criada na aula passada, agora será desenvolvida a interface para manipulação dos dados.
# Interface - Adicionar
---
![[Pasted image 20250903153058.png | 400]]

Adicionar.java
```java
String sexo;

private void btnAdicionarActionPerformed(java.awt.event.ActionEvent evt) {

	if(radMasculino.isSelected()){
		sexo = "M";
	}
	else if(radFeminino.isSelected()){
		sexo = "F";
	}
	
	Pessoa p = new Pessoa();
	p.setNome(txtNome.getText());
	p.setSexo(sexo);
	p.setIdioma((String) cmbIdioma.getSelectedItem());
	
	PessoaDAO pDAO = new PessoaDAO();
	pDAO.inserir(p);
	limparFormulario();
}
```

Adicionar.java
```java
private void limparFormulario(){
	txtNome.setText("");
	buttonGroup1.clearSelection();
	cmbIdioma.setSelectedIndex(0);
}
```

# Interface - Editar e Excluir
---
![[Pasted image 20250903153512.png | 400]]

PessoaDAO.java
```java
public Pessoa getPessoa(int id){
	String sql = "SELECT * FROM pessoa WHERE ID = ?";
	
	try{
		PreparedStatement stmt = conn.prepareStatement(sql, ResultSet.TYPE_SCROLL_INSENSITIVE, ResultSet.CONCUR_UPDATABLE);
		stmt.setInt(1, id);
		ResultSet rs = stmt.executeQuery();
		Pessoa p = new Pessoa();

		rs.first();
		p.setId(id);
		p.setNome(rs.getString("nome"));
		p.setSexo(rs.getString("sexo"));
		p.setIdioma(rs.getString("idioma"));
		return p;
		
	} catch (SQLException ex) {
		System.out.println("Erro ao inserir: "+ex.getMessage());
		return null;
	}
        
}
    
public void editar(Pessoa pessoa){
	String sql = "UPDATE pessoa set nome=?, sexo=?, idioma=? WHERE id=?";
	
	try{
		PreparedStatement stmt = conn.prepareStatement(sql, ResultSet.TYPE_SCROLL_INSENSITIVE, ResultSet.CONCUR_UPDATABLE);
		stmt.setString(1, pessoa.getNome());
		stmt.setString(2, pessoa.getSexo());
		stmt.setString(3, pessoa.getIdioma());
		stmt.setInt(4, pessoa.getId());
		stmt.execute();
	} catch (SQLException ex) {
		System.out.println("Erro ao inserir: "+ex.getMessage());
	}
}
    
public void excluir (int id){
	try {
		String sql = "DELETE FROM pessoa WHERE id=?";

		PreparedStatement stmt = conn.prepareStatement(sql);
		stmt.setInt(1, id);
		stmt.execute();
	} catch (SQLException ex) {
		System.out.println("Erro ao inserir: "+ex.getMessage());
	}
}
```

EditarExcluir.java
```java
private void ConsultarActionPerformed(java.awt.event.ActionEvent evt) {            
	int idPessoa = Integer.parseInt(txtID.getText());
	PessoaDAO pDAO = new PessoaDAO();
	
	Pessoa p = pDAO.getPessoa(idPessoa);
	if (p == null){
		limparFormulario();
		JOptionPane.showMessageDialog(this, "Pessoa não encontrada!");
	} else {
		txtID2.setText(String.valueOf(p.getId()));
		txtNome.setText(p.getNome());
		//txtSexo.setText(p.getSexo());
		if(p.getSexo().equals("M")){
			radMasculino.setSelected(true);
		} else {
			radFeminino.setSelected(true);
		}
		//txtIdioma.setText(p.getIdioma());
		cmbIdioma.setSelectedItem(p.getIdioma());
	}
}                                         

private void btnAtualizarActionPerformed(java.awt.event.ActionEvent evt) {                                             
	String sexo = null;
	if(radMasculino.isSelected()){
		sexo = "M";
	}
	else if (radFeminino.isSelected()){
		sexo = "F";
	}
	
	Pessoa p = new Pessoa();
	p.setId(Integer.parseInt(txtID.getText()));
	p.setNome(txtNome.getText());
	p.setSexo(sexo);
	p.setIdioma(cmbIdioma.getSelectedItem().toString());
	
	PessoaDAO pDAO = new PessoaDAO();
	pDAO.editar(p);
	limparFormulario();
}                                            

private void btnExcluirActionPerformed(java.awt.event.ActionEvent evt) {                                           
	int resposta = JOptionPane.showConfirmDialog(null, "Deseja realmente excluir?","Exclusão", JOptionPane.YES_NO_OPTION);
	if (resposta == JOptionPane.YES_NO_OPTION){
		PessoaDAO pDAO = new PessoaDAO();
		pDAO.excluir(Integer.parseInt(txtID.getText()));
		limparFormulario();
	}
} 
```